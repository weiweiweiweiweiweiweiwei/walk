<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>步數計算機</title>
  <style>
    /* 1. 全局風格：字體、背景、平滑過渡 */
    :root {
      --system-background: #f0f0f7;
      --card-background: #ffffff;
      --primary-text-color: #1d1d1f;
      --secondary-text-color: #6e6e73;
      --action-blue: #007aff;
      --font-family: -apple-system, BlinkMacSystemFont, "San Francisco", "Helvetica Neue", "Noto Sans TC", sans-serif;
    }

    body {
      font-family: var(--font-family);
      background-color: var(--system-background);
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* 2. 主卡片佈局：給予深度和呼吸空間 */
    .container {
      background-color: var(--card-background);
      border-radius: 20px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      padding: 2.5rem 2rem;
      max-width: 500px;
     
      width: 90%;
      text-align: center;
      transition: all 0.3s ease;
    }

    /* 3. 標題和描述：建立視覺層次 */
    h1 {
      color: var(--primary-text-color);
      font-size: 1.8rem;
      font-weight: 600;
      margin-top: 0;
      margin-bottom: 1.2rem;
    }

    p {
      color: var(--secondary-text-color);
      margin-top: 0;
      margin-bottom: 3rem;
      line-height: 1.5;
    }

    /* 4. 輸入框：清晰、易於互動 */
    .input-group {
      margin-bottom: 1.5rem;
    }

    #numberInput {
      font-family: var(--font-family);
      font-size: 1.2rem;
      font-weight: 500;
      text-align: center;
      width: calc(100% - 2rem);
      padding: 0.8rem 1rem;
      border: 1.5px solid #e5e5e5;
      border-radius: 12px;
      background-color: #f9f9f9;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }

    #numberInput:focus {
      outline: none;
      border-color: var(--action-blue);
      box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.2);
    }
    
    /* 5. 結果顯示：答案是英雄 */
    .result-area {
        margin-top: 2.5rem;
    }
    
    #resultText {
        font-size: 1rem;
        color: var(--secondary-text-color);
        margin: 0;
    }
    
    #resultSteps {
        font-size: 3.5rem;
        font-weight: 700;
        color: var(--primary-text-color);
        margin: 0.25rem 0 0 0;
        line-height: 1.2;
        /* 加入一個簡單的淡入動畫 */
        opacity: 0;
        transition: opacity 0.5s ease;
    }

    #resultSteps.visible {
        opacity: 1;
    }


  </style>
</head>
<body>

  <div class="container">
    <h1>步數計算機</h1>
    <p>輸入您心中默數到的最後一個數字，即可換算為總步數。</p>

    <div class="input-group">
      <input 
        type="number" 
        id="numberInput" 
        placeholder="輸入" 
        min="1"
        oninput="calculateSteps()"
      >
    </div>
    
    <div class="result-area">
        <p id="resultText">總步數是</p>
        <h2 id="resultSteps">0</h2>
    </div>

  </div>

  <script>
    // ----- 核心邏輯 -----
    const numberInput = document.getElementById('numberInput');
    const resultStepsEl = document.getElementById('resultSteps');

    // 建立一個快取，避免重複計算，提升效能
    const memo = {};

    function numberToChinese(num) {
      if (memo[num]) return memo[num];

      const digits = ["零", "一", "二", "三", "四", "五", "六", "七", "八", "九"];
      const units = ["", "十", "百", "千"];

      if (num === 0) return "零";
      if (num < 10) return digits[num];
      
      let str = "";
      const s = String(num);
      
      if(s.length === 2) { // 十位數的特殊處理
        const ten = Math.floor(num / 10);
        const one = num % 10;
        str = (ten > 1 ? digits[ten] : "") + units[1] + (one > 0 ? digits[one] : "");
        memo[num] = str;
        return str;
      }
      
      // 其他情況（百、千）
      for (let i = 0; i < s.length; i++) {
        const digit = parseInt(s[i]);
        const unit = units[s.length - 1 - i];
        
        if (digit === 0) {
            // 如果前一位不是零，且不是最後一位，才加上零
            if (i > 0 && s[i-1] !== '0' && i < s.length -1) {
                 str += digits[0];
            }
        } else {
             str += digits[digit] + unit;
        }
      }

      memo[num] = str.replace(/零+$/, ""); // 去除結尾的零
      return memo[num];
    }
    
    // 預先計算好的累計步數表，大大加速高數值計算
    const cumulativeSteps = { 0: 0 };
    let preCalculatedMax = 0;

    function calculateTotalSteps(maxNumber) {
        if (maxNumber <= 0 || isNaN(maxNumber)) {
            return 0;
        }

        // 如果輸入的數字在已計算範圍內，直接回傳
        if (maxNumber <= preCalculatedMax) {
            return cumulativeSteps[maxNumber];
        }

        let totalSteps = cumulativeSteps[preCalculatedMax];
        
        // 只計算新的部分
        for (let i = preCalculatedMax + 1; i <= maxNumber; i++) {
            totalSteps += numberToChinese(i).length;
            cumulativeSteps[i] = totalSteps;
        }

        // 更新已計算的最大值
        preCalculatedMax = maxNumber;

        return totalSteps;
    }


    // ----- 互動邏輯 -----
    function calculateSteps() {
      const value = parseInt(numberInput.value, 10);
      
      if (!value || value <= 0) {
        resultStepsEl.textContent = '0';
        resultStepsEl.classList.remove('visible');
        return;
      }
      
      const totalSteps = calculateTotalSteps(value);
      
      // 使用 toLocaleString() 來加上千分位符號，提升可讀性
      resultStepsEl.textContent = totalSteps.toLocaleString('en-US'); 
      resultStepsEl.classList.add('visible');
    }

  </script>
</body>
</html>
